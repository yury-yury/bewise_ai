## Задание
Время выполнения задания оценивается в 4-8 человеко-часов (для специалиста уровня Junior). 
Максимальный срок выполнения - до 23.10.2023. 

Результат выполнения задания должен быть выложен соискателем в публичный репозиторий github и помимо кода проекта содержать подробные инструкции по сборке и запуску. Ссылку на проект необходимо направить на почту: hr@bewise.ai в тексте письма указать ваше ФИО и ссылку на ваше резюме


### Задачи:

1. С помощью Docker (предпочтительно - docker-compose) развернуть образ с любой опенсорсной СУБД (предпочтительно - PostgreSQL). Предоставить все необходимые скрипты и конфигурационные (docker/compose) файлы для развертывания СУБД, а также инструкции для подключения к ней. Необходимо обеспечить сохранность данных при рестарте контейнера (то есть - использовать volume-ы для хранения файлов СУБД на хост-машине.


2. Реализовать на Python3 простой веб сервис (с помощью FastAPI или Flask, например), выполняющий следующие функции:
В сервисе должно быть реализовано REST API, принимающее на вход POST запросы с содержимым вида {"questions_num": integer}  ;

    После получения запроса сервис, в свою очередь, запрашивает с публичного API (англоязычные вопросы для викторин) https://jservice.io/api/random?count=1 указанное в полученном запросе количество вопросов.
    Далее, полученные ответы должны сохраняться в базе данных из п. 1, причем сохранена должна быть как минимум следующая информация (название колонок и типы данный можете выбрать сами, также можете добавлять свои колонки): 
```
    1. ID вопроса, 
    2. Текст вопроса, 
    3. Текст ответа, 
    4. Дата создания вопроса. 
```

В случае, если в БД имеется такой же вопрос, к публичному API с викторинами должны выполняться дополнительные запросы до тех пор, пока не будет получен уникальный вопрос для викторины.
Ответом на запрос из п.2.a должен быть предыдущей сохранённый вопрос для викторины. В случае его отсутствия - пустой объект.

3. В репозитории с заданием должны быть предоставлены инструкции по сборке докер-образа с сервисом из п. 2., его настройке и запуску. А также пример запроса к POST API сервиса.

4. Желательно, если при выполнении задания вы будете использовать docker-compose, SqlAalchemy,  пользоваться аннотацией типов.


## Описание выполненного тестового задания.

Для реализации требований тестового задания мной применен следующий стек технологий:
- Приложение реализовано с использованием асинхронного фреймворка FastAPI
- В качестве сервера использован Uvicorn
- В качестве ORM применен модуль SQLAlchemy
- Для определения моделей данных и валидации полученных значений используется библиотека Pydentic
- Асинхронные запросы к стороннему API производятся с помощью модуля aiohttp
- Состояние БД отслеживается с помощью библиотеки Alembic
- В качестве БД применена реляционная СУБД PostgreSQL
- Развертывание приложения производиться в Docker Compose
- Документация API создана на основе Swagger
- В корне проекта создана коллекция запросов к API c помощью Postman

### Развертывание проекта

1. Клонировать код на локальную машину.
2. В корне проекта создать файл .env содержащий значение переменных окружения для доступа к БД на основе файла sample.env 

#### Локальный запуск проекта

3. Перейти в корневую директорию проекта и создать и активировать виртуальное окружение (опционально), выполнив следующие команды в терминале:
```commandline
$ python3 -m venv venv
$ source venv/bin/activate
```
4. Установить зависимости используемые в проекте выполнив следующую команду в терминале:
```commandline
$ pip install -r requirements.txt
```
5. В СУБД PostgreSQL создать БД с именем и данными для доступа указанными в файле .env
6. Применить миграции к базе данных выполнив команду в терминале:
```commandline
$ alembic upgrade heads
```
7. Запустить сервер приложения выполнив команду в терминале:
```commandline
$ uvicorn main:app --host 0.0.0.0 --port 8000 
```
8. Документация API доступна по URL адресу "http://0.0.0.0:8000/docs/", там же имеется возможность выполнения запросов к API приложения
#### Запуск проекта в Docker Compose
1. Находясь в корневой директории проекта выполнить команду в терминале.
```commandline
$ docker compose up -d
```
Сборка и запуск контейнеров производиться автоматически. После старта контейнеров приложение будет отвечать на POST запросы по URL адресу "http://0.0.0.0:8000/quest/". 
Для сохранения состояния БД при рестарте контейнеров используется Volume.
